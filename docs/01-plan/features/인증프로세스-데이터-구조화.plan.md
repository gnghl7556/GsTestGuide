# Plan: 인증프로세스 데이터 구조화

> **Feature**: 인증프로세스-데이터-구조화
> **Phase**: Plan
> **Created**: 2026-02-10
> **Status**: Draft

---

## 1. 배경 및 문제점

현재 GS 인증 시험 4단계 프로세스(SETUP → DESIGN → EXECUTION → COMPLETION)의 핵심 데이터가 TypeScript 소스 코드에 하드코딩되어 있다.

### 하드코딩된 데이터 현황

| 파일 | 내용 | 데이터 규모 |
|------|------|------------|
| `src/data/constants.ts` | 4개 카테고리 정의 + 테마 색상 | 카테고리 4개, 색상 32개 속성 |
| `src/data/requirements.ts` | 시험 요구사항 DB (REQUIREMENTS_DB) | 11개 항목, 각각 checkPoints/evidence/passCriteria 포함 |
| `src/features/defects/data/defectReferences.ts` | 품질특성별 결함 사례 | 8개 카테고리, 약 25개 결함 사례 |
| `src/features/checklist/utils/executionGate.ts` | 실행 게이트 로직 + 하드코딩 ID | DUR-EXEC-02/03/04 ID 직접 참조 |
| `src/utils/checklistGenerator.ts` | 체크리스트 생성 로직 | 조건부 포함/제외 규칙 |

### 문제점
- 시험 항목 추가/수정 시 개발자가 직접 코드를 변경해야 함
- 결함 사례, 체크포인트 등 실무 데이터가 코드에 묻혀 관리가 어려움
- 비개발자(PL, 시험원)가 내용을 검토/수정할 수 없음
- 데이터와 로직이 혼재되어 재사용이 불가

---

## 2. 목표

**마크다운(.md) 파일 기반의 프로세스 데이터 관리 체계 구축**

1. 하드코딩된 프로세스 데이터를 옵시디언 호환 마크다운 파일로 분리
2. 앱이 빌드 시 마크다운 파일을 파싱하여 타입 안전한 데이터로 변환
3. 비개발자도 옵시디언에서 프로세스 데이터를 열람/수정 가능
4. GitHub 커밋으로 변경 이력 추적

---

## 3. 구조화 대상 데이터

### 3.1 시험 요구사항 (Requirements)
- **현재 위치**: `src/data/requirements.ts` (REQUIREMENTS_DB)
- **항목 수**: 11개
- **포함 정보**: id, category, title, description, checkPoints, evidenceExamples, passCriteria, requiredDocs, relatedInfo, keywords, inputFields, excludeConditions, includeConditions

### 3.2 결함 사례 (Defect References)
- **현재 위치**: `src/features/defects/data/defectReferences.ts`
- **카테고리**: 기능적합성, 성능효율성, 사용성, 신뢰성, 보안성, 유지보수성, 이식성, 일반적 요구사항, 호환성
- **포함 정보**: summary, description, severity, frequency

### 3.3 카테고리 & 테마 (Constants)
- **현재 위치**: `src/data/constants.ts`
- **항목**: 4개 카테고리 (SETUP, DESIGN, EXECUTION, COMPLETION)
- **테마 색상**: Tailwind CSS 클래스 매핑

### 3.4 실행 게이트 규칙 (Execution Gate)
- **현재 위치**: `src/features/checklist/utils/executionGate.ts`
- **규칙**: 회귀 테스트 결과에 따른 보안/성능 테스트 활성화 조건

---

## 4. 실무 기반 전체 프로세스 흐름

### 프로세스 개요

기존 코드의 4단계(SETUP → DESIGN → EXECUTION → COMPLETION)는 공식 분류이며,
실무에서는 아래 **7단계** 흐름으로 진행된다.

```
① 시험 준비 → ② 시험 착수 → ③ 초기 시험 → ④ 결함 리포트
→ ⑤ 패치 및 회귀 → ⑥ 인증위 심사 → ⑦ 시험 종료
```

---

### ① 시험 준비 (SETUP)

```
시험 배정 → PL 메일 수신
    │
    ├─ SETUP-01: 시험 확인
    │   ├─ PL 메일에서 시험번호, 시작일, 일정 등 기본 정보 확인
    │   ├─ 첨부자료 확인: 시험 합의서, 사용자 매뉴얼, 제품 설명서
    │   └─ 시험 합의서 내용 추출: 업체명, 제품명, 시험 조건, SW 요구사항 등 파싱
    │
    ├─ SETUP-02: 환경 구성 - 자리/장비
    │   ├─ 합의서/메일로 필요 장비 규모 파악
    │   ├─ 자리 배정 담당자에게 시험실 자리 요청 → 배정 확인
    │   ├─ 장비관리시스템에서 장비 예약 → 수령 → 설치
    │   └─ IODD 담당자에게 OS 설치 자료 대여
    │
    ├─ SETUP-03: 환경 구성 - SW
    │   ├─ 합의서 SW 요구사항에 맞게 OS 설치
    │   └─ 합의서에 명시된 필수 소프트웨어 설치
    │
    ├─ SETUP-04: 네트워크 설정
    │   ├─ IP 담당자에게 필요 IP 개수 요청 → 수령
    │   ├─ TTA 양식에 따라 설정:
    │   │   ├─ IP: 수령받은 IP
    │   │   ├─ 서브넷 마스크: 255.255.255.0
    │   │   ├─ 기본 게이트웨이: 210.104.181.1
    │   │   └─ DNS 서버: 168.126.63.1
    │   └─ 인터넷 연결 정상 작동 확인
    │
    └─ SETUP-05: 기타 환경 구성
        ├─ 서버 PC 포함 시 Putty 설치
        └─ SSH 접속 확인
```

### ② 시험 착수 (시험 시작일)

```
    ├─ 업체 방문 준비 (방문 인원/시간 확인)
    ├─ 업체 도착 → 배정 자리 안내
    ├─ PL 시험 전반 설명 (일정, 인증위, 패치 등) ← 설치 "전"
    ├─ 업체 제품 설치
    ├─ 업체 제품 설명 + 질의응답
    └─ 필요 정보 요청
        ├─ 합의서상 시험용 데이터 및 장비 정보 확인
        └─ 현장 제품 확인 후 필요한 추가 자료 요청
```

### ③ 초기 시험

```
    ├─ 제품 견적 (복잡도 1차 분석)
    ├─ 웹 제품 → 보안 테스트 도구(Invicti) 우선 예약 및 수행
    ├─ 기능 리스트 작성 + 기능 설명 + 결함 찾기 (동시 수행)
    ├─ 패치 전 캡처(RawData) 기능별 저장
    └─ ISO 25023/25051 품질특성 기반 결함 탐색
        └─ 일반 시험원: 결함 사례 모음 참고
```

### ④ 결함 리포트

```
    ├─ [1차 결함 리포트]
    │   ├─ 결함 보고서 양식 작성 + 증빙자료 (이미지/영상)
    │   ├─ 보안 도구(Invicti) 결과 포함 여부 판단 (결함 수/심각도 기준)
    │   └─ PL과 검토/수정 → PL이 업체에 메일 발송
    │
    ├─ [2차 결함 리포트] (1차와 약 4~5일 간격)
    │   ├─ 더 세부적 항목까지 테스트
    │   ├─ 성능 테스트 수행 (PL이 1차 날짜에 성능 시나리오 제공)
    │   ├─ 성능 결함 + 성능 테스트 보고서 포함
    │   └─ PL과 검토 → PL이 업체에 발송
    │
    └─ [업체 응답]
        ├─ 2차 리포트 제공일 하루 전 → 업체가 1차 리포트 응답
        └─ 1차 패치일 하루 전 → 업체가 2차 리포트 응답
```

### ⑤ 패치 및 회귀

```
    ├─ [1차 패치]
    │   ├─ 업체에 방문 인원/시간 사전 연락
    │   ├─ 패치 시간: 오전 9시 ~ 오후 6시
    │   ├─ 직접 방문 패치 (일반적) / 원격 시 RemoteView 사용
    │   └─ 패치 완료
    │
    ├─ [1차 패치 후 회귀 테스트] (약 3일)
    │   ├─ 보안 테스트 도구(Invicti) 재예약 및 수행
    │   │   └─ 도구 사용 중 제품 조작/다른 업무 불가
    │   ├─ 보안 테스트 중: 업체의 1차/2차 리포트 응답 검토
    │   │   └─ 회귀 테스트 방향 1차 파악
    │   ├─ 보안 테스트 완료 후: 결함 수정 여부 + 파생 결함 확인
    │   └─ '1차 회귀 리포트' 작성 (결함 리포트와 동일 양식)
    │
    ├─ [1차 회귀 리포트 제출] ← 분기점
    │   ├─ PL + 시험원 함께 검토 → PL이 업체에 제공
    │   │
    │   ├─ [Case A] 파생 결함 없음
    │   │   ├─ 패치 후 성능 테스트 수행
    │   │   └─ 성능 테스트 결과를 1차 회귀 리포트에 포함
    │   │
    │   └─ [Case B] 파생 결함 있음 → 2차 패치 필요
    │       └─ 성능 테스트는 2차 패치 이후로 연기
    │           └─ (이유: 성능 테스트가 복잡하고 시간 소요가 큼)
    │
    ├─ [2차 패치] ← 마지막 패치 기회
    │   ├─ 업체 방문 패치 (1차 패치와 동일 절차)
    │   └─ 패치 완료
    │
    └─ [2차 패치 후 회귀 테스트]
        ├─ 보안 테스트 도구(Invicti) 재수행
        ├─ 결함 수정 여부 + 파생 결함 확인
        ├─ 성능 테스트 수행 (Case B에서 연기된 경우)
        └─ '2차 회귀 리포트' 작성 → PL과 검토 → 업체 제공
```

### ⑥ 인증위 심사

```
    └─ PL이 일정 조율 → 인증심사위원회에서 제품 최종 검증
```

### ⑦ 시험 종료

```
    ├─ [최종 시험품 수령]
    │   ├─ 업체가 최종 시험품을 CD로 제공 (시험 결과와 무관)
    │   ├─ 포함: 프로그램, 사용자 매뉴얼, 제품설명서 등 (최초 제공과 동일 형태)
    │   ├─ 프로그램 개발 코드의 해시값 필수 포함
    │   └─ 전달: 직접 방문 / 퀵 / 소포
    │
    ├─ [최종 산출물 작성]
    │   ├─ 패치 후 RawData 캡처 (기능별 이미지)
    │   ├─ 기능 리스트 완성 (인증위 전까지, 공식적으로 PL 작성 항목)
    │   └─ 기능 리스트 기반 테스트 케이스 작성
    │
    ├─ [최종 산출물 점검]
    │   ├─ 1. 패치 전/후 RawData (기능별 캡처 이미지)
    │   ├─ 2. 패치 전/후 보안성 테스트 보고서 (Invicti 스캔 결과)
    │   ├─ 3. 패치 전/후 성능 테스트 보고서
    │   └─ 4. 테스트 케이스
    │   ※ 결함 리포트/회귀 리포트는 별도 관리 (최종 산출물에 미포함)
    │
    └─ [물리적 마무리]
        ├─ 장비 반납 (장비관리시스템 반납 처리)
        ├─ IP 반환
        └─ 시험실 정리
```

---

## 5. 제안하는 마크다운 폴더 구조

```
content/                          ← 프로세스 데이터 루트
├── README.md                     ← 전체 구조 안내 (옵시디언 홈)
├── process/                      ← 7단계 프로세스 정의
│   ├── _index.md                 ← 프로세스 전체 개요
│   ├── 01-시험준비/
│   │   ├── _index.md
│   │   ├── SETUP-01-시험확인.md
│   │   ├── SETUP-02-환경구성-자리장비.md
│   │   ├── SETUP-03-환경구성-SW.md
│   │   ├── SETUP-04-네트워크-설정.md
│   │   └── SETUP-05-기타-환경구성.md
│   ├── 02-시험착수/
│   │   └── _index.md             ← 업체 방문, 제품 설치, 정보 요청
│   ├── 03-초기시험/
│   │   └── _index.md             ← 견적, 보안도구 예약, 기능분석+결함발견
│   ├── 04-결함리포트/
│   │   ├── _index.md             ← 리포트 작성 흐름
│   │   ├── 1차-결함리포트.md
│   │   └── 2차-결함리포트.md
│   ├── 05-패치-회귀/
│   │   ├── _index.md             ← 패치/회귀 전체 흐름 + 분기 조건
│   │   ├── 1차-패치-회귀.md
│   │   └── 2차-패치-회귀.md
│   ├── 06-인증위-심사/
│   │   └── _index.md
│   └── 07-시험종료/
│       ├── _index.md
│       ├── 최종시험품-수령.md
│       ├── 최종산출물-작성.md
│       └── 물리적-마무리.md
├── defect-references/            ← 결함 사례 DB
│   ├── _index.md
│   ├── 기능적합성.md
│   ├── 성능효율성.md
│   ├── 사용성.md
│   ├── 신뢰성.md
│   ├── 보안성.md
│   ├── 유지보수성.md
│   ├── 이식성.md
│   ├── 일반적-요구사항.md
│   └── 호환성.md
├── templates/                    ← 양식/템플릿 참조
│   ├── 결함-보고서-양식.md
│   ├── 성능-테스트-보고서.md
│   └── 기능-리스트-양식.md
├── rules/                        ← 실행 규칙
│   ├── execution-gate.md         ← 회귀 결과에 따른 성능/보안 분기
│   └── checklist-conditions.md   ← 체크리스트 포함/제외 조건
└── theme/
    └── categories.md             ← 카테고리 정의 + 테마 색상
```

### 마크다운 파일 형식 (예시: 요구사항)

```markdown
---
id: ENV-01
category: SETUP
title: 자리 배정
---

## 설명
자리 배정 여부와 시험에 필요한 장비·공간 확보 상태를 확인한다.

## 체크포인트
- [ ] 시험 배정 후, 시험 자리가 이미 배정되었나요?
- [ ] 시험에 필요한 장비 및 공간을 확인했나요?

## 증빙 예시
- 시험 합의서
- 자리 배정표
- 현장 배치 사진

## 합격 기준
시험 자리 배정이 완료되었고 시험 수행에 적합한 공간이 확보되었다.

## 참조 문서
| 문서명 | 종류 | 설명 |
|--------|------|------|
| 시험 합의서 | file | 시험 범위와 조건이 명시된 합의서를 확인하세요 |
| 자리 배정표 | external | 시험 자리 배정 내역을 확인하세요 |

## 참조 정보
| 항목 | 내용 |
|------|------|
| 자리 배정 담당자 | 이예정 전임 |
| 연락처 | 010-5110-4917 |
| 이메일 | yeijeong@tta.or.kr |
```

---

## 5. 기술 전략

### 5.1 빌드 타임 파싱
- Vite 플러그인 또는 빌드 스크립트로 `content/` 폴더의 마크다운을 파싱
- YAML frontmatter → 메타데이터, 본문 → 구조화된 데이터
- 파싱 결과를 기존 `Requirement[]`, `DefectReference[]` 타입으로 변환
- 기존 컴포넌트 코드 변경 최소화

### 5.2 사용할 라이브러리
- `gray-matter`: YAML frontmatter 파싱
- `remark` / `unified`: 마크다운 본문 → AST 변환
- Vite plugin (커스텀): 빌드 시 `content/` 디렉토리 스캔

### 5.3 마이그레이션 전략
1. `content/` 폴더에 마크다운 파일 생성 (기존 데이터 기반)
2. 마크다운 파서 + Vite 플러그인 구현
3. 기존 `requirements.ts`, `defectReferences.ts`를 파서 출력으로 교체
4. 기존 TypeScript 하드코딩 파일 삭제
5. 기존 타입 인터페이스는 유지 (호환성)

---

## 6. 옵시디언 호환성

- 모든 파일이 표준 마크다운 + YAML frontmatter → 옵시디언에서 바로 열림
- `[[링크]]` 문법은 사용하지 않음 (빌드 파싱 단순화)
- 폴더 구조가 옵시디언 사이드바에서 자연스럽게 탐색 가능
- `_index.md` 파일로 각 폴더의 개요를 제공

---

## 7. 범위 (Scope)

### In Scope
- 하드코딩 데이터 → 마크다운 파일 분리
- 빌드 타임 마크다운 파서 구현
- 기존 컴포넌트와의 연동 유지
- 옵시디언에서 열람/편집 가능

### Out of Scope (이후 과제)
- 관리자 페이지에서의 실시간 편집 (과제 1번)
- PDF 파싱 개선 (과제 3번)
- 디자인 통일성 (과제 5번)

---

## 8. 예상 작업 항목

| # | 작업 | 설명 |
|---|------|------|
| 1 | `content/` 폴더 구조 생성 | 위 4번 구조대로 폴더/파일 생성 |
| 2 | 기존 데이터 → 마크다운 변환 | requirements.ts, defectReferences.ts 등 변환 |
| 3 | 마크다운 파서 유틸리티 구현 | frontmatter + 본문 → 기존 타입 변환 |
| 4 | Vite 플러그인 구현 | 빌드 시 content/ 자동 스캔 및 번들링 |
| 5 | 기존 import 교체 | REQUIREMENTS_DB 등을 파서 출력으로 교체 |
| 6 | 기존 하드코딩 파일 정리 | 불필요해진 .ts 데이터 파일 삭제 |
| 7 | 동작 검증 | 기존 기능 정상 동작 확인 |

---

## 9. 성공 기준

- [ ] `content/` 폴더의 마크다운 파일만 수정하면 앱에 반영됨
- [ ] 옵시디언에서 프로세스 데이터를 자연스럽게 탐색/편집 가능
- [ ] 기존 UI/기능에 영향 없음 (타입 호환성 유지)
- [ ] `src/data/requirements.ts`와 `src/features/defects/data/defectReferences.ts`의 하드코딩 제거
